{% extends 'base/base.html' %}
{% load static %}

{% block extra_css %}
<link rel="stylesheet" href="{% static 'css/dashboard.css' %}">
{% endblock %}

{% block content %}
<div class="user-dashboard">
    <!-- Welcome Header -->
    <div class="welcome-header">
        <div>
            <h1 class="welcome-title">Welcome back, <span class="username">{{ user.username }}</span>!</h1>
            <p class="welcome-subtitle">Here's what's happening with your documents today.</p>
        </div>
        <div class="user-badge">
            <span>ğŸ‘¤</span>
            {{ user.profile.get_role_display|default:"User" }}
        </div>
    </div>
    
    <!-- Quick Search -->
    <div class="quick-search">
        <form action="{% url 'search:search' %}" method="get" class="search-form">
            <input type="text" name="q" placeholder="Quick search your documents by title, author, or tags..." 
                   class="search-input">
            <button type="submit" class="search-btn">Search</button>
            <a href="{% url 'search:search' %}" class="advanced-btn">Advanced</a>
        </form>
    </div>
    
    <!-- Quick Actions Grid -->
    <div class="actions-grid">
        <a href="{% url 'documents:upload' %}" class="action-card upload">
            <div class="action-icon">ğŸ“¤</div>
            <div class="action-content">
                <h3 class="action-title">Upload Document</h3>
                <p class="action-desc">Upload new documents to the system</p>
                <span class="action-link">Upload â†’</span>
            </div>
        </a>
        
        <a href="{% url 'documents:my_documents' %}" class="action-card documents">
            <div class="action-icon">ğŸ“</div>
            <div class="action-content">
                <h3 class="action-title">My Documents</h3>
                <p class="action-desc">View and manage your uploaded documents</p>
                <span class="action-link">View All â†’</span>
            </div>
        </a>
        
        <a href="{% url 'search:search' %}" class="action-card search">
            <div class="action-icon">ğŸ”</div>
            <div class="action-content">
                <h3 class="action-title">Search Documents</h3>
                <p class="action-desc">Advanced search with filters and sorting</p>
                <span class="action-link">Search â†’</span>
            </div>
        </a>
    </div>
    
    <!-- Admin/Manager Tools (Conditional) -->
    {% if user.is_staff or user.profile.role == 'admin' or user.profile.role == 'manager' %}
    <div class="admin-tools">
        <h2 class="section-title">âš™ï¸ Management Tools</h2>
        <div class="admin-actions">
            <a href="{% url 'access:user_list' %}" class="admin-action">
                <span>ğŸ‘¥</span>
                <span>Manage Users</span>
            </a>
            <a href="{% url 'review:dashboard' %}" class="admin-action">
                <span>ğŸ“‹</span>
                <span>Review Queue</span>
            </a>
            <a href="{% url 'access:admin_dashboard' %}" class="admin-action">
                <span>ğŸ“Š</span>
                <span>Admin Dashboard</span>
            </a>
        </div>
    </div>
    {% endif %}
    
    <!-- Recent Documents -->
    <div class="recent-documents">
        <div class="section-header">
            <h2 class="section-title">ğŸ“„ Recent Documents</h2>
            <a href="{% url 'documents:my_documents' %}" class="view-all">View All â†’</a>
        </div>
        
        {% include 'search/recent.html' %}
    </div>
    
    <!-- Quick Stats -->
    <div class="quick-stats">
        <div class="stat-item">
            <div class="stat-value">{{ user.documents.count|default:"0" }}</div>
            <div class="stat-label">Total Documents</div>
        </div>
        <div class="stat-item">
            <div class="stat-value">{{ approved_count|default:"0" }}</div>
            <div class="stat-label">Approved</div>
        </div>
        <div class="stat-item">
            <div class="stat-value">{{ pending_count|default:"0" }}</div>
            <div class="stat-label">Pending</div>
        </div>
        <div class="stat-item">
            <div class="stat-value">{{ under_review_count|default:"0" }}</div>
            <div class="stat-label">Under Review</div>
        </div>
        <div class="stat-item">
            <div class="stat-value">{{ rejected_count|default:"0" }}</div>
            <div class="stat-label">Rejected</div>
        </div>
    </div>
</div>
{% endblock %}